<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8' />
    <title>pomelo API</title>
    <meta http-equiv='content-type' content='text/html' />
    <meta http-equiv='content-style-type' content='text/css' />
    <meta http-equiv='content-script-type' content='text/javascript' />
    <meta name='author' content='netease' />
    <meta name='version' content='1.0' />
    <meta name='keywords' content='' />
    <meta name='description' content='' />

    <link type='text/css' rel='stylesheet' href='css/base.css'>
    <link type='text/css' rel='stylesheet' href='css/api.css'>

    <script>
      var raw = [{"id":"8-1352365450958","name":"DataSync","signiture":"DataSync()","type":"function","ctx":{"type":"function","name":"DataSync","string":"DataSync()"},"description":{"full":"<p>DataSync Components.</p>\n\n<p>Initialize a new <code>DataSync</code> with the given <code>options</code>.</p>\n\n<p>DataSync's prototype is based on <code>commands</code> under the same directory;</p>","summary":"<p>DataSync Components.</p>","body":"<p>Initialize a new <code>DataSync</code> with the given <code>options</code>.</p>\n\n<p>DataSync's prototype is based on <code>commands</code> under the same directory;</p>"},"full_description":"<p>DataSync Components.</p>\n\n<p>Initialize a new <code>DataSync</code> with the given <code>options</code>.</p>\n\n<p>DataSync's prototype is based on <code>commands</code> under the same directory;</p>","code":"var DataSync = function(options) {\n\toptions = options || {};\n\tthis.dbs = [];\n\tthis.selectDB(0);\n\tthis.client = options.client;\n\tthis.aof = options.aof || false;\n\tthis.log = options.log || console;\n\tthis.interval = options.interval || 1000 * 60;\n\tthis.flushQueue =  new Queue();\n\tthis.mergerMap = {};\n\tif (!!this.aof) {\n\t\tif (!!options.filename) {\n\t\t\tthis.filename = options.filename;\n\t\t} else {\n\t\t\tvar path = process.cwd() + '/logs';\n\t\t\tfs.mkdirSync(path);\n\t\t\tthis.filename = path+'/dbsync.log';\n\t\t}\n\t\tthis.stream = fs.createWriteStream(this.filename, { flags: 'a' });\n\t}\n\tif (!!options.mapping){\n\t\tthis.mapping = options.mapping;\n\t} else if (!!options.mappingPath) {\n\t\tthis.mapping = this.loadMapping(options.mappingPath); \n\t}\n\tthis.rewriter = options.rewriter || new Rewriter(this);\n\tthis.timer = options.timer || new SyncTimer();\n\tthis.timer.start(this);\n};","params":[{"type":"param","types":["Object"],"name":"options","description":"init params include aof,log,interval,mapping and mappingPath etc."}],"has_params":true,"tags":[{"type":"class","string":"DataSync"},{"type":"constructor","string":""},{"type":"param","types":["Object"],"name":"options","description":"init params include aof,log,interval,mapping and mappingPath etc."}],"module":true,"related":{"href":""},"has_related":true,"methods":[]},{"id":"51-1352365450959","name":"execSync","signiture":"exports.execSync()","type":"method","ctx":{"type":"method","receiver":"exports","name":"execSync","string":"exports.execSync()"},"description":{"full":"<p>invoke tick instant </p>","summary":"<p>invoke tick instant </p>","body":""},"full_description":"<p>invoke tick instant </p>","code":"exports.execSync = function(key,val,cb){\n   this.rewriter.tick(key,val,cb);\n};","params":[{"type":"param","types":["String"],"name":"key","description":""},{"type":"param","types":["Object"],"name":"val","description":""},{"type":"param","types":["Function"],"name":"cb","description":""}],"has_params":true,"tags":[{"type":"module","string":""},{"type":"","string":""},{"type":"param","types":["String"],"name":"key","description":""},{"type":"param","types":["Object"],"name":"val","description":""},{"type":"param","types":["Function"],"name":"cb","description":""}],"module":true,"related":{"href":""},"has_related":true,"methods":[]},{"id":"52-1352365450959","name":"exec","signiture":"exports.exec()","type":"method","ctx":{"type":"method","receiver":"exports","name":"exec","string":"exports.exec()"},"description":{"full":"<p>exec add be synced data to queue <br />invoke by timer</p>","summary":"<p>exec add be synced data to queue <br />invoke by timer</p>","body":""},"full_description":"<p>exec add be synced data to queue  invoke by timer</p>","code":"exports.exec = function(){\n    var mergerKey;\n    switch (arguments.length) {\n    case 2:\n        this.enqueue(arguments[0],arguments[1]);\n        break;\n    case 3:\n        mergerKey = [arguments[0],arguments[1]].join('');\n        this.mergerMap[mergerKey] = {key:arguments[0],val:clone(arguments[2])};\n        this.writeToAOF(arguments[0], [arguments[2]]);\n        break;\n    default:\n        break;\n    }\n};","params":[],"has_params":false,"tags":[{"type":"module","string":""}],"module":true,"related":{"href":""},"has_related":true,"methods":[]},{"id":"55-1352365450959","name":"isDone","signiture":"exports.isDone()","type":"method","ctx":{"type":"method","receiver":"exports","name":"isDone","string":"exports.isDone()"},"description":{"full":"<p>reutrn queue is empty or not when shutdown server </p>","summary":"<p>reutrn queue is empty or not when shutdown server </p>","body":""},"full_description":"<p>reutrn queue is empty or not when shutdown server </p>","code":"exports.isDone = function(){\n    var writerEmpty = true,queueEmpty = false,mapEmpty = false;\n    if (!!this.rewriter) {\n\t\t\twriterEmpty = this.rewriter.isDone();\n\t\t}\n    queueEmpty = (this.flushQueue.getLength()===0);\n    mapEmpty = (utils.getMapLength(this.mergerMap)===0);\n    return writerEmpty && queueEmpty && mapEmpty;\n};","params":[],"has_params":false,"tags":[{"type":"module","string":""}],"module":true,"related":{"href":""},"has_related":true,"methods":[]}]
    </script>
    <!-- Array，String，Object扩展函数（因为IE9-不支持，而Lunr有使用到) -->
    <script src='js/extend.js'></script>
    <!-- 将原来引用网上的jquery转为引用本地的 -->
    <script src='js/jquery-1.6.4-min.js'></script>
    <!-- 将Lunr和页面逻辑整合一起放在lunr.js文件 -->
    <script src='js/lunr.js'></script>
  </head>
  <body>
    <!-- 顶栏 -->
    <div class="g-bar">
      <!-- 顶栏github模块 -->
      <div class="m-github">
          <span class="title">gitHub:</span><a class="link" target="_blank" href="#">http://github.com/NetEase/pomelo</a>
      </div>
    </div>
    <!-- 头部 -->
    <div class="g-hd">
      <div class="m-hdnav">
        	<div class="bg">
         	<div class="wrap">
          		<ul class="cnt">
                  	  <li class="current"><a href="index.html">Home</a></li>
                  	  <li><a href="api.html">Api</a></li>
                          <li><a href="demo.html">Demo</a></li>
                   	  <li><a href="community.html">Community</a></li>
                    	  <li><a href="https://github.com/NetEase/pomelo/wiki" class="last">Wiki</a></li>
                	</ul>	
         	 	</div>
          </div>
          <div class="logo"><a href="#"><div class="img"></div></a></div>
      </div>
    </div>
    <!-- 整体居中 -->
    <div class="g-doc">
      <!-- 主体 -->
      <div class="g-bd">
        <!-- API主体 -->
        <div class="m-wrap">
          <!-- API -->
          <div class='main'>
            <div class='maintt'>
              <h1> Pomelo-Sync<span class='version'>0.0.1</span></h1>
            </div>
      
            
              <div class='cls' id='DataSync'>
                <div class='clstt'>
                  <h2>DataSync</h2>
                </div>
      
                <div class='clsdes'>
                  <p>DataSync Components.</p>

<p>Initialize a new <code>DataSync</code> with the given <code>options</code>.</p>

<p>DataSync's prototype is based on <code>commands</code> under the same directory;</p>
                </div>
      
                
              </div>
            
              <div class='cls' id='execSync'>
                <div class='clstt'>
                  <h2>execSync</h2>
                </div>
      
                <div class='clsdes'>
                  <p>invoke tick instant </p>
                </div>
      
                
              </div>
            
              <div class='cls' id='exec'>
                <div class='clstt'>
                  <h2>exec</h2>
                </div>
      
                <div class='clsdes'>
                  <p>exec add be synced data to queue  invoke by timer</p>
                </div>
      
                
              </div>
            
              <div class='cls' id='isDone'>
                <div class='clstt'>
                  <h2>isDone</h2>
                </div>
      
                <div class='clsdes'>
                  <p>reutrn queue is empty or not when shutdown server </p>
                </div>
      
                
              </div>
            
          </div>
          <!-- API导航 -->
          <div class='side'>
            <div class='m-nav'>
              <div class='m-search'>
                <input type="text" id="search-input" placeholder="Search"></input>
                <div id="search-results"></div>
              </div>
              <ul>
                
                  <li>
                    <h3><a target='DataSync' class='cap'>DataSync</a></h3>
                    <ul>
                      
                    </ul>
                  </li>
                
                  <li>
                    <h3><a target='execSync' class='cap'>execSync</a></h3>
                    <ul>
                      
                    </ul>
                  </li>
                
                  <li>
                    <h3><a target='exec' class='cap'>exec</a></h3>
                    <ul>
                      
                    </ul>
                  </li>
                
                  <li>
                    <h3><a target='isDone' class='cap'>isDone</a></h3>
                    <ul>
                      
                    </ul>
                  </li>
                
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- 尾部 -->
    <div class="g-ft">
      <!-- 尾部模块 -->
      <div class="m-ft">
	copyright 2012, NetEase, Inc. All Rights Reserved.
      </div>
    </div>
    <!-- 向上图标 -->
    <div class='m-arrow f-dn'><a href="#"></a></div>
    <!-- 代码高亮模块 -->
    <script src='js/hijs.js'></script>
    <!-- 页面效果模块 -->
    <script src='js/api.js'></script>
  </body>
</html>
